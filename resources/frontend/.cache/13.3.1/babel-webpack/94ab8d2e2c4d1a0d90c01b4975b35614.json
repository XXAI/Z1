{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, ViewChild } from '@angular/core';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MatExpansionPanel } from '@angular/material/expansion';\nimport { MatTable } from '@angular/material/table';\nimport { ConfirmActionDialogComponent } from '../../../utils/confirm-action-dialog/confirm-action-dialog.component';\nimport { FormularioComponent } from '../formulario/formulario.component';\nlet ListaComponent = class ListaComponent {\n  constructor(sharedService, coloniasService, dialog, fb, mediaObserver) {\n    this.sharedService = sharedService;\n    this.coloniasService = coloniasService;\n    this.dialog = dialog;\n    this.fb = fb;\n    this.mediaObserver = mediaObserver;\n    this.isLoading = false;\n    this.showMyStepper = false;\n    this.searchQuery = '';\n    this.resultsLength = 0;\n    this.currentPage = 0;\n    this.pageSize = 20;\n    this.selectedItemIndex = -1;\n    this.displayedColumns = ['Distrito', 'Municipio', 'Colonia', 'actions'];\n    this.dataSource = [];\n  }\n\n  ngOnInit() {\n    this.loadColoniaData(null);\n  }\n\n  loadColoniaData(event) {\n    this.isLoading = true;\n    let params;\n\n    if (!event) {\n      params = {\n        page: 1,\n        per_page: 20\n      };\n    } else {\n      params = {\n        page: event.pageIndex + 1,\n        per_page: event.pageSize\n      };\n    }\n\n    params.query = this.searchQuery;\n    this.coloniasService.getColonias(params).subscribe(response => {\n      this.dataSource = response.data.data;\n      console.log(this.dataSource);\n      this.isLoading = false;\n    }, errorResponse => {\n      var errorMessage = \"Ocurrió un error.\";\n\n      if (errorResponse.status == 409) {\n        errorMessage = errorResponse.error.message;\n      }\n\n      this.sharedService.showSnackBar(errorMessage, null, 3000);\n      this.isLoading = false;\n    });\n    return event;\n  }\n\n  cleanSearch() {\n    this.searchQuery = '';\n  }\n\n  agregarColonia() {\n    let configDialog = {};\n\n    if (this.mediaSize == 'xs') {\n      configDialog = {\n        maxWidth: '60vw',\n        maxHeight: '100vh',\n        data: {}\n      };\n    } else {\n      configDialog = {\n        width: '40%',\n        maxHeight: '60vh',\n        data: {}\n      };\n    }\n\n    const dialogRef = this.dialog.open(FormularioComponent, configDialog);\n    dialogRef.afterClosed().subscribe(valid => {\n      if (valid) {\n        this.loadColoniaData(); //console.log('Aceptar');\n      } else {\n        console.log('Cancelar');\n      }\n    });\n  }\n\n  editaColonia(obj) {\n    let configDialog = {};\n\n    if (this.mediaSize == 'xs') {\n      configDialog = {\n        maxWidth: '60vw',\n        maxHeight: '100vh',\n        data: {\n          id: obj.id\n        }\n      };\n    } else {\n      configDialog = {\n        width: '40%',\n        maxHeight: '60vh',\n        data: {\n          id: obj.id\n        }\n      };\n    }\n\n    const dialogRef = this.dialog.open(FormularioComponent, configDialog);\n    dialogRef.afterClosed().subscribe(valid => {\n      if (valid) {\n        this.loadColoniaData(); //console.log('Aceptar');\n      } else {\n        console.log('Cancelar');\n      }\n    });\n  }\n\n  eliminaColonia(obj) {\n    const dialogRef = this.dialog.open(ConfirmActionDialogComponent, {\n      width: '500px',\n      data: {\n        dialogTitle: 'ELIMINAR',\n        dialogMessage: '¿Realmente desea eliminar este registro? Escriba ACEPTAR a continuación para realizar el proceso.',\n        validationString: 'ACEPTAR',\n        btnColor: 'primary',\n        btnText: 'Aceptar'\n      }\n    });\n    dialogRef.afterClosed().subscribe(valid => {\n      if (valid) {\n        this.coloniasService.eliminarColonia(obj.id).subscribe(response => {\n          console.log(response);\n          this.sharedService.showSnackBar(\"Se ha Actualizado Correctamente\", null, 3000);\n          this.isLoading = false;\n          this.loadColoniaData();\n        }, errorResponse => {\n          this.isLoading = false;\n          var errorMessage = \"Ocurrió un error.\";\n\n          if (errorResponse.status == 409) {\n            errorMessage = errorResponse.error.error.message;\n          }\n\n          this.sharedService.showSnackBar(errorMessage, \"ERROR\", 3000);\n        });\n      }\n    });\n  }\n\n  applyFilter() {\n    this.loadColoniaData();\n  }\n\n};\n\n__decorate([ViewChild(MatPaginator)], ListaComponent.prototype, \"paginator\", void 0);\n\n__decorate([ViewChild(MatTable)], ListaComponent.prototype, \"usersTable\", void 0);\n\n__decorate([ViewChild(MatExpansionPanel)], ListaComponent.prototype, \"advancedFilter\", void 0);\n\nListaComponent = __decorate([Component({\n  selector: 'app-lista',\n  templateUrl: './lista.component.html',\n  styleUrls: ['./lista.component.css']\n})], ListaComponent);\nexport { ListaComponent };","map":null,"metadata":{},"sourceType":"module"}